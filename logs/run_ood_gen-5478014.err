The following modules were not unloaded:
  (Use "module --force purge" to unload all):

  1) xalt/3.1.4
`torch_dtype` is deprecated! Use `dtype` instead!
[1;36m(EngineCore_DP0 pid=1593564)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=1593564)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=1593564)[0;0m   File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=1593564)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=1593564)[0;0m   File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=1593564)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=1593564)[0;0m   File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/v1/engine/core.py", line 712, in run_engine_core
[1;36m(EngineCore_DP0 pid=1593564)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=1593564)[0;0m   File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/v1/engine/core.py", line 699, in run_engine_core
[1;36m(EngineCore_DP0 pid=1593564)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=1593564)[0;0m   File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/v1/engine/core.py", line 498, in __init__
[1;36m(EngineCore_DP0 pid=1593564)[0;0m     super().__init__(vllm_config, executor_class, log_stats,
[1;36m(EngineCore_DP0 pid=1593564)[0;0m   File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/v1/engine/core.py", line 83, in __init__
[1;36m(EngineCore_DP0 pid=1593564)[0;0m     self.model_executor = executor_class(vllm_config)
[1;36m(EngineCore_DP0 pid=1593564)[0;0m   File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/executor/executor_base.py", line 54, in __init__
[1;36m(EngineCore_DP0 pid=1593564)[0;0m     self._init_executor()
[1;36m(EngineCore_DP0 pid=1593564)[0;0m   File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/executor/uniproc_executor.py", line 54, in _init_executor
[1;36m(EngineCore_DP0 pid=1593564)[0;0m     self.collective_rpc("init_device")
[1;36m(EngineCore_DP0 pid=1593564)[0;0m   File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/executor/uniproc_executor.py", line 83, in collective_rpc
[1;36m(EngineCore_DP0 pid=1593564)[0;0m     return [run_method(self.driver_worker, method, args, kwargs)]
[1;36m(EngineCore_DP0 pid=1593564)[0;0m   File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/utils/__init__.py", line 3122, in run_method
[1;36m(EngineCore_DP0 pid=1593564)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=1593564)[0;0m   File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/worker/worker_base.py", line 259, in init_device
[1;36m(EngineCore_DP0 pid=1593564)[0;0m     self.worker.init_device()  # type: ignore
[1;36m(EngineCore_DP0 pid=1593564)[0;0m   File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/v1/worker/gpu_worker.py", line 161, in init_device
[1;36m(EngineCore_DP0 pid=1593564)[0;0m     current_platform.set_device(self.device)
[1;36m(EngineCore_DP0 pid=1593564)[0;0m   File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/platforms/cuda.py", line 79, in set_device
[1;36m(EngineCore_DP0 pid=1593564)[0;0m     torch.cuda.set_device(device)
[1;36m(EngineCore_DP0 pid=1593564)[0;0m   File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/torch/cuda/__init__.py", line 569, in set_device
[1;36m(EngineCore_DP0 pid=1593564)[0;0m     torch._C._cuda_setDevice(device)
[1;36m(EngineCore_DP0 pid=1593564)[0;0m torch.AcceleratorError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
[1;36m(EngineCore_DP0 pid=1593564)[0;0m CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
[1;36m(EngineCore_DP0 pid=1593564)[0;0m For debugging consider passing CUDA_LAUNCH_BLOCKING=1
[1;36m(EngineCore_DP0 pid=1593564)[0;0m Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[1;36m(EngineCore_DP0 pid=1593564)[0;0m 
Traceback (most recent call last):
  File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/scratch/gautschi/alochab/E3-RL4LLMs/e3/main_infer.py", line 119, in <module>
    main(args)
  File "/scratch/gautschi/alochab/E3-RL4LLMs/e3/main_infer.py", line 8, in main
    llm = LLM(
  File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/entrypoints/llm.py", line 297, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
  File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/v1/engine/llm_engine.py", line 177, in from_engine_args
    return cls(vllm_config=vllm_config,
  File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/v1/engine/llm_engine.py", line 114, in __init__
    self.engine_core = EngineCoreClient.make_client(
  File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/v1/engine/core_client.py", line 80, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
  File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/v1/engine/core_client.py", line 602, in __init__
    super().__init__(
  File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/v1/engine/core_client.py", line 448, in __init__
    with launch_core_engines(vllm_config, executor_class,
  File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/contextlib.py", line 142, in __exit__
    next(self.gen)
  File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/v1/engine/utils.py", line 732, in launch_core_engines
    wait_for_engine_startup(
  File "/scratch/gautschi/alochab/conda_envs/e3/lib/python3.10/site-packages/vllm/v1/engine/utils.py", line 785, in wait_for_engine_startup
    raise RuntimeError("Engine core initialization failed. "
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}
